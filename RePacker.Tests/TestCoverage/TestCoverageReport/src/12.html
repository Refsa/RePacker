<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Refsa\Documents\repackage\csharp\RePacker\Packer\RePacking.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using RePacker.Buffers;
using RePacker.Utils;
using RePacker.Builder;

namespace RePacker
{
    public static class RePacking
    {
#if NO_LOGGING
        static RePackerSettings settings = new RePackerSettings(false);
#else
        static RePackerSettings settings = new RePackerSettings();
#endif
        internal static RePackerSettings Settings =&gt; settings;
        internal static ILogger Logger =&gt; settings.Log;

        public static bool IsSetup =&gt; TypeCache.IsSetup;

#if !NO_BOOTSTRAP
        static RePacking()
        {
            Init();
        }
#endif

        public static void Init()
        {
            if (!IsSetup)
            {
                TypeCache.Setup();
            }
            else
            {
                TypeCache.Reload();
            }
        }

        /// &lt;summary&gt;
        /// Initialize RePacker with user specified settings
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;settings_&quot;&gt;wanted settings&lt;/param&gt;
        public static void Init(RePackerSettings settings_)
        {
            settings = settings_;
            Init();
        }

        public static void SetSettings(RePackerSettings settings_)
        {
            settings = settings_;
        }

        /// &lt;summary&gt;
        /// Pack value into buffer
        /// 
        /// Any value of T needs to be supported either internally or externally with RePackerWrapper&lt;T&gt;
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;buffer&quot;&gt;target buffer&lt;/param&gt;
        /// &lt;param name=&quot;value&quot;&gt;target value&lt;/param&gt;
        /// &lt;typeparam name=&quot;T&quot;&gt;type of value&lt;/typeparam&gt;
        public static void Pack&lt;T&gt;(Buffer buffer, ref T value)
        {
            TypeCache.Pack&lt;T&gt;(buffer, ref value);
        }

        /// &lt;summary&gt;
        /// Auto sizes a buffer and packs value into it
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;value&quot;&gt;&lt;/param&gt;
        /// &lt;typeparam name=&quot;T&quot;&gt;&lt;/typeparam&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static Buffer Pack&lt;T&gt;(ref T value)
        {
            var buffer = new Buffer(SizeOf(ref value), true);
            Pack(buffer, ref value);
            return buffer;
        }

        /// &lt;summary&gt;
        /// Unpack value of type T from buffer
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;buffer&quot;&gt;target buffer&lt;/param&gt;
        /// &lt;typeparam name=&quot;T&quot;&gt;Wanted type to extract&lt;/typeparam&gt;
        /// &lt;returns&gt;The extracted value as a new instance of type T&lt;/returns&gt;
        public static T Unpack&lt;T&gt;(Buffer buffer)
        {
            return TypeCache.Unpack&lt;T&gt;(buffer);
        }

        /// &lt;summary&gt;
        /// Unpacks value of type T into an out parameter
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;buffer&quot;&gt;target buffer&lt;/param&gt;
        /// &lt;param name=&quot;target&quot;&gt;output target&lt;/param&gt;
        /// &lt;typeparam name=&quot;T&quot;&gt;type of value&lt;/typeparam&gt;
        public static void UnpackOut&lt;T&gt;(Buffer buffer, out T target)
        {
            target = TypeCache.Unpack&lt;T&gt;(buffer);
        }

        /// &lt;summary&gt;
        /// Unpacks value of type T into an existing instance of T
        /// 
        /// Requires the correct implementation of RePackerWrapper&lt;T&gt;::UnpackInto to work
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;buffer&quot;&gt;buffer to unpack from&lt;/param&gt;
        /// &lt;param name=&quot;target&quot;&gt;target object to unpack into&lt;/param&gt;
        /// &lt;typeparam name=&quot;T&quot;&gt;type of object to unpack&lt;/typeparam&gt;
        public static void UnpackInto&lt;T&gt;(Buffer buffer, ref T target)
        {
            TypeCache.UnpackInto&lt;T&gt;(buffer, ref target);
        }

        /// &lt;summary&gt;
        /// Returns the byte size of value
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;value&quot;&gt;value to get size of&lt;/param&gt;
        /// &lt;typeparam name=&quot;T&quot;&gt;&lt;/typeparam&gt;
        /// &lt;returns&gt;size of value in bytes&lt;/returns&gt;
        public static int SizeOf&lt;T&gt;(ref T value)
        {
            return TypeCache.GetSize&lt;T&gt;(ref value);
        }

        internal static void AddTypePackerProvider&lt;T&gt;(GenericProducer producer)
        {
            TypeCache.AddTypePackerProvider(typeof(T), producer);
        }

        internal static void AttemptToCreatePacker(System.Type type)
        {
            TypeCache.AttemptToCreatePacker(type);
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[12,9,12,67,1],[12,9,12,67,1],[12,9,12,67,1],[12,9,12,67,1],[12,9,12,67,1],[14,54,14,62,1],[14,54,14,62,1],[14,54,14,62,1],[14,54,14,62,1],[14,54,14,62,1],[15,43,15,55,1],[15,43,15,55,1],[15,43,15,55,1],[15,43,15,55,1],[15,43,15,55,1],[17,39,17,56,1],[17,39,17,56,1],[17,39,17,56,1],[17,39,17,56,1],[17,39,17,56,1],[21,9,21,10,1],[21,9,21,10,1],[21,9,21,10,1],[21,9,21,10,1],[21,9,21,10,1],[22,13,22,20,1],[22,13,22,20,1],[22,13,22,20,1],[22,13,22,20,1],[22,13,22,20,1],[23,9,23,10,1],[23,9,23,10,1],[23,9,23,10,1],[23,9,23,10,1],[23,9,23,10,1],[27,9,27,10,1],[27,9,27,10,1],[27,9,27,10,1],[27,9,27,10,1],[27,9,27,10,1],[28,13,28,26,1],[28,13,28,26,1],[28,13,28,26,1],[28,13,28,26,1],[28,13,28,26,1],[29,13,29,14,1],[29,13,29,14,1],[29,13,29,14,1],[29,13,29,14,1],[29,13,29,14,1],[30,17,30,35,1],[30,17,30,35,1],[30,17,30,35,1],[30,17,30,35,1],[30,17,30,35,1],[31,13,31,14,1],[31,13,31,14,1],[31,13,31,14,1],[31,13,31,14,1],[31,13,31,14,1],[33,13,33,14,0],[33,13,33,14,0],[33,13,33,14,0],[33,13,33,14,0],[33,13,33,14,0],[34,17,34,36,0],[34,17,34,36,0],[34,17,34,36,0],[34,17,34,36,0],[34,17,34,36,0],[35,13,35,14,0],[35,13,35,14,0],[35,13,35,14,0],[35,13,35,14,0],[35,13,35,14,0],[36,9,36,10,1],[36,9,36,10,1],[36,9,36,10,1],[36,9,36,10,1],[36,9,36,10,1],[43,9,43,10,0],[43,9,43,10,0],[43,9,43,10,0],[43,9,43,10,0],[43,9,43,10,0],[44,13,44,34,0],[44,13,44,34,0],[44,13,44,34,0],[44,13,44,34,0],[44,13,44,34,0],[45,13,45,20,0],[45,13,45,20,0],[45,13,45,20,0],[45,13,45,20,0],[45,13,45,20,0],[46,9,46,10,0],[46,9,46,10,0],[46,9,46,10,0],[46,9,46,10,0],[46,9,46,10,0],[49,9,49,10,1],[49,9,49,10,1],[49,9,49,10,1],[49,9,49,10,1],[49,9,49,10,1],[50,13,50,34,1],[50,13,50,34,1],[50,13,50,34,1],[50,13,50,34,1],[50,13,50,34,1],[51,9,51,10,1],[51,9,51,10,1],[51,9,51,10,1],[51,9,51,10,1],[51,9,51,10,1],[62,9,62,10,1],[62,9,62,10,1],[62,9,62,10,1],[62,9,62,10,1],[62,9,62,10,1],[63,13,63,50,1],[63,13,63,50,1],[63,13,63,50,1],[63,13,63,50,1],[63,13,63,50,1],[64,9,64,10,1],[64,9,64,10,1],[64,9,64,10,1],[64,9,64,10,1],[64,9,64,10,1],[73,9,73,10,0],[73,9,73,10,0],[73,9,73,10,0],[73,9,73,10,0],[73,9,73,10,0],[74,13,74,62,0],[74,13,74,62,0],[74,13,74,62,0],[74,13,74,62,0],[74,13,74,62,0],[75,13,75,37,0],[75,13,75,37,0],[75,13,75,37,0],[75,13,75,37,0],[75,13,75,37,0],[76,13,76,27,0],[76,13,76,27,0],[76,13,76,27,0],[76,13,76,27,0],[76,13,76,27,0],[77,9,77,10,0],[77,9,77,10,0],[77,9,77,10,0],[77,9,77,10,0],[77,9,77,10,0],[86,9,86,10,1],[86,9,86,10,1],[86,9,86,10,1],[86,9,86,10,1],[86,9,86,10,1],[87,13,87,48,1],[87,13,87,48,1],[87,13,87,48,1],[87,13,87,48,1],[87,13,87,48,1],[88,9,88,10,1],[88,9,88,10,1],[88,9,88,10,1],[88,9,88,10,1],[88,9,88,10,1],[97,9,97,10,0],[97,9,97,10,0],[97,9,97,10,0],[97,9,97,10,0],[97,9,97,10,0],[98,13,98,50,0],[98,13,98,50,0],[98,13,98,50,0],[98,13,98,50,0],[98,13,98,50,0],[99,9,99,10,0],[99,9,99,10,0],[99,9,99,10,0],[99,9,99,10,0],[99,9,99,10,0],[110,9,110,10,1],[110,9,110,10,1],[110,9,110,10,1],[110,9,110,10,1],[110,9,110,10,1],[111,13,111,57,1],[111,13,111,57,1],[111,13,111,57,1],[111,13,111,57,1],[111,13,111,57,1],[112,9,112,10,1],[112,9,112,10,1],[112,9,112,10,1],[112,9,112,10,1],[112,9,112,10,1],[121,9,121,10,1],[121,9,121,10,1],[121,9,121,10,1],[121,9,121,10,1],[121,9,121,10,1],[122,13,122,52,1],[122,13,122,52,1],[122,13,122,52,1],[122,13,122,52,1],[122,13,122,52,1],[123,9,123,10,1],[123,9,123,10,1],[123,9,123,10,1],[123,9,123,10,1],[123,9,123,10,1],[126,9,126,10,0],[126,9,126,10,0],[126,9,126,10,0],[126,9,126,10,0],[126,9,126,10,0],[127,13,127,66,0],[127,13,127,66,0],[127,13,127,66,0],[127,13,127,66,0],[127,13,127,66,0],[128,9,128,10,0],[128,9,128,10,0],[128,9,128,10,0],[128,9,128,10,0],[128,9,128,10,0],[131,9,131,10,0],[131,9,131,10,0],[131,9,131,10,0],[131,9,131,10,0],[131,9,131,10,0],[132,13,132,51,0],[132,13,132,51,0],[132,13,132,51,0],[132,13,132,51,0],[132,13,132,51,0],[133,9,133,10,0],[133,9,133,10,0],[133,9,133,10,0],[133,9,133,10,0],[133,9,133,10,0]]);
    </script>
  </body>
</html>