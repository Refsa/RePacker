<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Refsa\Documents\repackage\csharp\RePacker\Packer\Producers\CollectionsProducer.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using RePacker.Utils;

namespace RePacker.Builder
{
    internal class IListProducer : GenericProducer
    {
        public override Type ProducerFor =&gt; typeof(IList&lt;&gt;);

        public override ITypePacker GetProducer(Type type)
        {
            var elementType = type.GetGenericArguments()[0];

            if (TypeCache.TryGetTypeInfo(elementType, out var _))
            {
                return (ITypePacker)Activator.CreateInstance(typeof(IListPacker&lt;&gt;).MakeGenericType(elementType));
            }
            else if (elementType.IsValueType || elementType.IsUnmanagedStruct())
            {
                return (ITypePacker)Activator.CreateInstance(typeof(IListUnmanagedPacker&lt;&gt;).MakeGenericType(elementType));
            }

            return null;
        }
    }

    internal class ListProducer : GenericProducer
    {
        public override Type ProducerFor =&gt; typeof(List&lt;&gt;);

        public override ITypePacker GetProducer(Type type)
        {
            var elementType = type.GetGenericArguments();
            var instance = Activator.CreateInstance(typeof(ListPacker&lt;&gt;).MakeGenericType(elementType));
            return (ITypePacker)instance;
        }
    }

    internal class StackProducer : GenericProducer
    {
        public override Type ProducerFor =&gt; typeof(Stack&lt;&gt;);

        public override ITypePacker GetProducer(Type type)
        {
            var elementType = type.GetGenericArguments();
            var instance = Activator.CreateInstance(typeof(StackPacker&lt;&gt;).MakeGenericType(elementType));
            return (ITypePacker)instance;
        }
    }

    internal class QueueProducer : GenericProducer
    {
        public override Type ProducerFor =&gt; typeof(Queue&lt;&gt;);

        public override ITypePacker GetProducer(Type type)
        {
            var elementType = type.GetGenericArguments();
            var instance = Activator.CreateInstance(typeof(QueuePacker&lt;&gt;).MakeGenericType(elementType));
            return (ITypePacker)instance;
        }
    }

    internal class HashSetProducer : GenericProducer
    {
        public override Type ProducerFor =&gt; typeof(HashSet&lt;&gt;);

        public override ITypePacker GetProducer(Type type)
        {
            var elementType = type.GetGenericArguments();
            var instance = Activator.CreateInstance(typeof(HashSetPacker&lt;&gt;).MakeGenericType(elementType));
            return (ITypePacker)instance;
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[9,45,9,60,1],[9,45,9,60,1],[9,45,9,60,1],[9,45,9,60,1],[9,45,9,60,1],[12,9,12,10,1],[12,9,12,10,1],[12,9,12,10,1],[12,9,12,10,1],[12,9,12,10,1],[13,13,13,61,1],[13,13,13,61,1],[13,13,13,61,1],[13,13,13,61,1],[13,13,13,61,1],[15,13,15,66,1],[15,13,15,66,1],[15,13,15,66,1],[15,13,15,66,1],[15,13,15,66,1],[16,13,16,14,1],[16,13,16,14,1],[16,13,16,14,1],[16,13,16,14,1],[16,13,16,14,1],[17,17,17,114,1],[17,17,17,114,1],[17,17,17,114,1],[17,17,17,114,1],[17,17,17,114,1],[19,18,19,81,0],[19,18,19,81,0],[19,18,19,81,0],[19,18,19,81,0],[19,18,19,81,0],[20,13,20,14,0],[20,13,20,14,0],[20,13,20,14,0],[20,13,20,14,0],[20,13,20,14,0],[21,17,21,123,0],[21,17,21,123,0],[21,17,21,123,0],[21,17,21,123,0],[21,17,21,123,0],[24,13,24,25,0],[24,13,24,25,0],[24,13,24,25,0],[24,13,24,25,0],[24,13,24,25,0],[25,9,25,10,1],[25,9,25,10,1],[25,9,25,10,1],[25,9,25,10,1],[25,9,25,10,1],[30,45,30,59,1],[30,45,30,59,1],[30,45,30,59,1],[30,45,30,59,1],[30,45,30,59,1],[33,9,33,10,1],[33,9,33,10,1],[33,9,33,10,1],[33,9,33,10,1],[33,9,33,10,1],[34,13,34,58,1],[34,13,34,58,1],[34,13,34,58,1],[34,13,34,58,1],[34,13,34,58,1],[35,13,35,104,1],[35,13,35,104,1],[35,13,35,104,1],[35,13,35,104,1],[35,13,35,104,1],[36,13,36,42,1],[36,13,36,42,1],[36,13,36,42,1],[36,13,36,42,1],[36,13,36,42,1],[37,9,37,10,1],[37,9,37,10,1],[37,9,37,10,1],[37,9,37,10,1],[37,9,37,10,1],[42,45,42,60,1],[42,45,42,60,1],[42,45,42,60,1],[42,45,42,60,1],[42,45,42,60,1],[45,9,45,10,1],[45,9,45,10,1],[45,9,45,10,1],[45,9,45,10,1],[45,9,45,10,1],[46,13,46,58,1],[46,13,46,58,1],[46,13,46,58,1],[46,13,46,58,1],[46,13,46,58,1],[47,13,47,105,1],[47,13,47,105,1],[47,13,47,105,1],[47,13,47,105,1],[47,13,47,105,1],[48,13,48,42,1],[48,13,48,42,1],[48,13,48,42,1],[48,13,48,42,1],[48,13,48,42,1],[49,9,49,10,1],[49,9,49,10,1],[49,9,49,10,1],[49,9,49,10,1],[49,9,49,10,1],[54,45,54,60,1],[54,45,54,60,1],[54,45,54,60,1],[54,45,54,60,1],[54,45,54,60,1],[57,9,57,10,1],[57,9,57,10,1],[57,9,57,10,1],[57,9,57,10,1],[57,9,57,10,1],[58,13,58,58,1],[58,13,58,58,1],[58,13,58,58,1],[58,13,58,58,1],[58,13,58,58,1],[59,13,59,105,1],[59,13,59,105,1],[59,13,59,105,1],[59,13,59,105,1],[59,13,59,105,1],[60,13,60,42,1],[60,13,60,42,1],[60,13,60,42,1],[60,13,60,42,1],[60,13,60,42,1],[61,9,61,10,1],[61,9,61,10,1],[61,9,61,10,1],[61,9,61,10,1],[61,9,61,10,1],[66,45,66,62,1],[66,45,66,62,1],[66,45,66,62,1],[66,45,66,62,1],[66,45,66,62,1],[69,9,69,10,1],[69,9,69,10,1],[69,9,69,10,1],[69,9,69,10,1],[69,9,69,10,1],[70,13,70,58,1],[70,13,70,58,1],[70,13,70,58,1],[70,13,70,58,1],[70,13,70,58,1],[71,13,71,107,1],[71,13,71,107,1],[71,13,71,107,1],[71,13,71,107,1],[71,13,71,107,1],[72,13,72,42,1],[72,13,72,42,1],[72,13,72,42,1],[72,13,72,42,1],[72,13,72,42,1],[73,9,73,10,1],[73,9,73,10,1],[73,9,73,10,1],[73,9,73,10,1],[73,9,73,10,1]]);
    </script>
  </body>
</html>